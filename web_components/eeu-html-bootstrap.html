<!-- This set of components only requires base Polymer class and Bootstrap, no Polymer CSS Elements -->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css" >
<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap-theme.min.css" >
<!-- link rel="import" href="../bower_components/iron-input/iron-input.html" -->


<!-- i do not recommend a header web component like this, since it is not universal, but it sure is nice here -->
<dom-module id="eeu-header" >
    <template>
        <nav class="navbar navbar-inverse navbar-fixed-top">

            <ul class="nav nav-pills">

                <li role="presentation" class="" ><a href="../index.html">Home</a></li>

                <li role="presentation" class="dropdown active">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        Demo Pages <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li role="presentation">
                            <a href="../views/eeu_bootstrap_demo.html" data-target="views/eeu_bootstrap_demo.html" >EEU HTML Bootstrap Components</a>
                        </li>
                        <li role="presentation">
                            <a href="../views/eeu_paper_demo.html" data-target="views/eeu_paper_demo.html" >EEU HTML Paper Element Components</a>
                        </li>
                    </ul>
                </li>

                <li role="presentation">
                    <a href="https://github.com/kajackdfw/eeu_components" target="_blank">
                        Get The Code
                    </a>
                </li>

                <li role="presentation">
                    <a href="https://www.polymer-project.org/1.0/" target="_blank">
                        Get Polymer
                    </a>
                </li>

            </ul>

        </nav>
    </template>
    <script>
        Polymer({

            is: "eeu-header",

            properties: {
                activePage: {
                    type: String
                }
            },

            ready: function () {
                $('.dropdown-toggle').dropdown();
                console.log('Header Ready');
            }
        });
    </script>

</dom-module>


<dom-module id="eeu-double-select">

    <template>

        <style>

            .btn-group>.btn:first-child:not(:last-child):not(.dropdown-toggle) {
                color: #555 !important;
                background-image: none ;
                background: white !important;
            }

            .form-inline > label { width: 6em; text-align: right; }
            .form > label { width: 6em; text-align: right; }

        </style>

        <template is="dom-if" if="[[label]]">
            <label class="control-label" >{{label}}</label>
        </template>

        <div class="btn-group">

            <input type="text" class="btn btn-default btn-input" placeholder="[[placeholdertext]]" value="[[selectedname]]" readonly >
            <input type="hidden" value="[[selectedid]]" name="[[name]]" >

            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" >
                <span class="caret"></span>
                <span class="sr-only">Toggle Dropdown</span>
            </button>

                <ul class="dropdown-menu">

                    <template is="dom-repeat" items="[[itemChoices]]">
                        <li><a on-click=newselection id="{{item.id}}" >{{item.name}}</a></li>
                    </template>

                    <template is="dom-if" if="[[typeSelected]]">
                        <li role="separator" class="divider"></li>
                        <li><a on-click=newtype data-type="none">Change from <b>{{typeSelected}}</b> to ...</a></li>
                    </template>

                    <template is="dom-if" if="[[noType]]">
                        <li><a on-click=newtype data-type="Aluminum">Aluminum</a></li>
                        <li><a on-click=newtype data-type="Steel">Steel</a></li>
                    </template>

                </ul>
        </div>

    </template>
    <script>
        Polymer({
            is: "eeu-double-select",
            properties: {
                name: {
                    type: String
                },
                label: {
                    type: String
                },
                selectData: {
                    type: Array
                },
                typename: {
                    type: String
                },
                selectedname: {
                    type: String
                },
                selectedid: {
                    type: String
                 },
                typeSelected: {
                    type: String
                },
                typeChoice: {
                    type: String,
                    value: "Select Matl"
                },
                itemChoices: {
                    type: Array
                },
                noType: {
                    type: Boolean,
                    value: true
                },
                noSelection: {
                    type: Boolean,
                    value: false
                },
                placeholdertext: {
                    type: String
                }
            },
            ready: function() {

                this.selectData = [
                    {"type": 'Aluminum',"name":"Angle 2'' x 2''  1/4''", "id":"34"},
                    {"type": 'Aluminum',"name":"Angle 3\" x 3\"  1/4\"", "id":"35"},
                    {"type": 'Steel',"name":"C6\" x 8.2", "id":"64"},
                    {"type": 'Steel',"name":"1/4\" x 2\" Bar", "id":"65"},
                    {"type": 'Steel',"name":"1/4\" x 3\" Bar", "id":"66"}
                ];

                // initialize typeChoices
                var maxTypes = this.selectData.length ;
                var typeArray = new Array( maxTypes );
                $.each(this.selectData, function( index, value )
                {
                    typeArray[ value['type'] ] = value['type'] ;
                });

                this.placeholdertext = 'Choose a '+ this.typename + ' Type.';

                $('.dropdown-toggle').dropdown();
            },

            newselection: function () {
                if(typeof event.target.attributes['id'] !== 'undefined')
                {
                    var newId = Number(event.target.attributes['id'].value);
                    var newName = 'processing!';
                }
                else
                {
                    var newId = 0;
                    var newName = 'Choose a ' + this.typename ;
                }

                $.each(this.selectData, function( index, value )
                {
                    if( value['id'] == newId )
                    {
                        newName =  value['name'];
                    }
                });

                this.placeholdertext = newName ;
                this.selectedname = newName ;
                this.selectedid   = newId ;

            },

            newtype: function() {

                if(typeof event.target.attributes['data-type'] !== 'undefined')
                {
                    var newTypeSelected = String(event.target.attributes['data-type'].value);
                    this.placeholdertext = 'Choose a '+ this.typename ;
                }
                else
                {
                    var newTypeSelected = 'none';
                }

                if( newTypeSelected == 'none' )
                {
                    var newTypeSelected = 'none';
                    this.noType = true ;
                    this.itemChoices = new Array();
                    this.typeSelected = '';
                    this.placeholdertext = 'Choose a '+ this.typename + ' Type.';
                    return ;
                }

                this.typeSelected = newTypeSelected ;

                var expectedChoices = 0;

                $.each(this.selectData, function (index, value)
                {
                    if (value['type'] == newTypeSelected) {
                        expectedChoices = expectedChoices + 1;
                    }
                });


                if( expectedChoices > 0 )
                {
                    this.noType = false ;
                }
                else
                {
                    this.noType = true ;
                }

                var newCtr = -1;
                var newArray = new Array( expectedChoices );
                $.each( this.selectData, function( index, value )
                {
                    if( value['type'] == newTypeSelected )
                    {
                        newCtr = newCtr + 1;
                        newArray[newCtr] = new Array(2);
                        newArray[newCtr]['id'] = value['id'];
                        newArray[newCtr]['name'] = value['name'];
                    }
                });
                this.itemChoices = newArray ;
            }
        });

    </script>

</dom-module>


<dom-module id="eeu-alert" >

    <template>

        <template is="dom-if" if="[[successmessage]]">
            <div class="alert alert-success" role="alert">
                <span>{{message}}</span>
            </div>
        </template>

        <template is="dom-if" if="[[errormessage]]">
            <div class="alert alert-danger" role="alert">
                <span>{{message}}</span>
            </div>
        </template>

        <template is="dom-if" if="[[warningmessage]]">
            <div class="alert alert-warning" role="alert">
                <span>{{message}}</span>
            </div>
        </template>

    </template>

    <script>

        Polymer({

            is: "eeu-alert",

            properties: {
                message: {
                    type: String
                },
                messagetype: {
                    type: String
                },
                successmessage: {
                    type: Boolean,
                    value: false
                },
                warningmessage: {
                    type: Boolean,
                    value: false
                },
                errormessage: {
                    type: Boolean,
                    value: false
                },
            },

            ready: function() {
                if( this.messagetype == 'success' ) {
                    this.successmessage = true ;
                }
                else if( this.messagetype == 'error' ) {
                    this.errormessage = true ;
                }
                else if( this.messagetype == 'warning' )
                {
                    this.warningmessage = true ;
                }
            }

        });

    </script>
</dom-module>


<dom-module id="eeu-string">

    <template>

        <div class$="{{formGroupClass}}">
            <label class="control-label" for="inputError1">{{messageValidationError}}</label>
            <input type="text" class="form-control" id="inputError1" value="{{message::input}}" placeholder="{{label}}" on-keyup="messageChanged">
        </div>
    </template>

    <script>
        Polymer({
            is: "eeu-string",
            properties: {
                message: {
                    type: String
                },
                messageValidationError: {
                    type: String,
                    value: ""
                },
                minLength: {
                    type: String
                },
                maxLength: {
                    type: String
                },
                formGroupClass: {
                    type: String,
                    value: "form-group"
                },
                label: {
                    type: String
                },
                value: {
                    type: String
                },
                min: {
                    type: String
                },
                max: {
                    type: String
                }
            },
            messageChanged: function() {
                var trimmedMessage = this.message.trim();
                if (trimmedMessage.length < this.min || trimmedMessage.length > this.max ) {
                    this.messageValidationError = 'Must be between ' +
                            this.min + ' and ' +
                            this.max + ' characters.';
                    this.formGroupClass = "form-group has-error";
                } else {
                    this.messageValidationError = this.label;
                    this.formGroupClass = "form-group";
                }
            },
            ready: function () {
                this.message = this.value;
                this.messageValidationError = this.label;
            }

        });
    </script>
</dom-module>


<dom-module id="eeu-string-inline">
    <template>

        <style>
            .form-inline > label { width: 6em; text-align: right; }
            .form > label { width: 6em; text-align: right; }
        </style>

        <div class$="{{inputGroupClass}}">
                <!-- use the ::input extension to Bind this native html input field to our web component -->
                <input type="text" id="message"
                       name="{{name}}"
                       value="{{message::input}}"
                       placeholder="{{label}}"
                       class="form-control"
                       on-keyup="messageChanged"
                       aria-describedby="basic-addon2"
                       style="width: 9em;" />
                <span class="input-group-addon" id="basic-addon2a" style="width: 5em;">{{messageValidationError}}</span>
            </div>

    </template>
    <script>
        Polymer({
            is: "eeu-string-inline",
            properties: {
                message: {
                    type: String
                },
                messageValidationError: {
                    type: String,
                    value: ""
                },
                minLength: {
                    type: String
                },
                maxLength: {
                    type: String
                },
                inputGroupClass: {
                    type: String,
                    value: "input-group"
                },
                label: {
                    type: String
                },
                value: {
                    type: String
                },
                min: {
                    type: String
                },
                max: {
                    type: String
                },
                statusColor: {
                    type: String,
                    value: "input-group"
                }
            },
            messageChanged: function() {
                var trimmedMessage = this.message.trim();
                if (trimmedMessage.length < this.min) {
                    this.messageValidationError = this.min + ' min.';
                    this.inputGroupClass = "input-group has-error";
                }
                else if( trimmedMessage.length > this.max ) {
                    this.messageValidationError = this.max + ' max.';
                    this.inputGroupClass = "input-group has-error";
                } else {
                    this.messageValidationError = '';
                    this.inputGroupClass = "input-group";
                }
            },
            ready: function () {
                this.message = this.value;
                this.inputGroupClass = "input-group";
            }

        });
    </script>
</dom-module>



<dom-module id="eeu-dec-to-frac" >

    <template>

        <style>
            .form-inline > label { width: 6em; text-align: right; }
            .form > label { width: 6em; text-align: right; }
            .form-group > div > input { width: 7em; }
            .form-group > div > .input-group-addon { width: 7em; }
        </style>

        <div class="form-group">

            <label for="userstring">{{label}}</label>

            <div class$="{{statusColor}}">
                <!-- use the ::input extension to Bind this native html input field to our web component -->
                <input type="text" id="userstring"
                       name="{{name}}"
                       value="{{userstring::input}}"
                       class="form-control"
                       on-keyup="userstringChanged"
                       aria-describedby="basic-addon2"
                />
                <span class="input-group-addon" id="basic-addon2" >{{fifdimension}}</span>
            </div>
        </div>
    </template>

    <script>

        function isNumeric(n) { return !isNaN(parseFloat(n)) && isFinite(n); }

        Polymer({

            is: "eeu-dec-to-frac",

            properties: {
                userstring: {
                    type: String
                },
                value: {
                    type: String,
                    value: "0"
                },
                name: {
                    type: String,
                    value: "undefined"
                },
                label: {
                    type: String
                },
                fstyle: {
                    type: String
                },
                isValid: {
                    type: Boolean,
                    value: true
                },
                statusColor: {
                    type: String,
                    value: "input-group"
                }
            },

            ready: function() {
                this.userstring = this.value;
                this.userstringChanged();
                console.log('Ready');
            },

            fifreset: function() {
                this.userstring = '';
                this.fifdimension = '0"';
            },

            userstringChanged: function() {
                var someString = this.userstring ;
                var feet = 0;
                var inches = 0;
                var denominator = 64 ;
                var numerator = 0;

                if( isNumeric( someString ) )
                {
                    someString = Math.round( someString * 64 ) / 64 ;
                    feet = Math.floor( someString / 12 );
                    inch = Math.floor( someString - ( feet * 12 )) ;
                    numerator = Math.round(( someString - ( feet * 12 ) - inch ) * denominator );

                    for( denom = denominator; denom > 1 && ( numerator % 2 ) == 0 && numerator >= 1 ; denom--  )
                    {
                        numerator = numerator / 2 ;
                        denominator = denominator / 2 ;
                    }

                    if( feet > 0 )
                    {
                        this.fifdimension = feet + "'-" + inch ;
                    }
                    else
                    {
                        this.fifdimension = inch ;
                    }

                    if( numerator > 0 )
                    {
                        this.fifdimension = this.fifdimension + '-' + numerator + '/' + denominator + '"';
                    }
                    else
                    {
                        this.fifdimension = this.fifdimension + '"'
                    }
                    this.isValid = true ;
                    this.statusColor = "input-group";
                }
                else
                {
                    this.fifdimension = 'Invalid';
                    this.isValid = false;
                    this.statusColor = "input-group has-error";
                }
            }
        });

    </script>

</dom-module>


<dom-module id="eeu-dec-to-frac-ro" >

    <template>
        <style>
            .eeu-dec-to-frac-ro > input {
                background: white;
                width: 7em;
            }
        </style>

        <template is="dom-if" if="[[isPlain]]">
            <span>{{fifracString}}</span>
        </template>

        <template is="dom-if" if="[[isInputGroup]]">
            <div class="form-group eeu-dec-to-frac-ro" >
                <input value="{{fifracString}}" class="form-control" readonly>
            </div>
        </template>

    </template>

    <script>

        function isNumeric(n) { return !isNaN(parseFloat(n)) && isFinite(n); }

        Polymer({

            is: "eeu-dec-to-frac-ro",

            properties: {
                fifracString: {
                    type: String
                },
                value: {
                    type: String,
                    value: "0\""
                },
                fstyle: {
                    type: String,
                    value: "default"
                },
                isPlain: {
                    type: Boolean,
                    value: false
                }
                ,
                isInputGroup: {
                    type: Boolean,
                    value: false
                }
            },

            ready: function() {
                this.convertToFifrac();
                if( this.fstyle == 'plain' ) {
                    this.isPlain = true ;
                }
                else {
                    this.isInputGroup = true ;
                }
            },

            convertToFifrac: function() {
                var someString = this.value ;
                var feet = 0;
                var inches = 0;
                var denominator = 64 ;
                var numerator = 0;

                if( isNumeric( someString ) )
                {
                    someString = Math.round( someString * 64 ) / 64 ;
                    feet = Math.floor( someString / 12 );
                    inch = Math.floor( someString - ( feet * 12 )) ;
                    numerator = Math.round(( someString - ( feet * 12 ) - inch ) * denominator );

                    for( denom = denominator; denom > 1 && ( numerator % 2 ) == 0 && numerator >= 1 ; denom--  )
                    {
                        numerator = numerator / 2 ;
                        denominator = denominator / 2 ;
                    }

                    if( feet > 0 )
                    {
                        this.fifracString = feet + "'-" + inch ;
                    }
                    else
                    {
                        this.fifracString = inch ;
                    }

                    if( numerator > 0 )
                    {
                        this.fifracString = this.fifracString + '-' + numerator + '/' + denominator + '"';
                    }
                    else
                    {
                        this.fifracString = this.fifracString + '"'
                    }
                }
                else
                {
                    this.fifracString = ' ';
                }
            }
        });

    </script>

</dom-module>


