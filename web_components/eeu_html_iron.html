<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/iron-input/iron-input.html">
<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap-theme.min.css">


<dom-module id="editable-fifrac-dimension" >

    <template>
        <p>
            Convert <strong>{{userstring}}</strong> and put in label below.
        </p>

        <br />

        <div class="input-group">
            <input is="iron-input"
                   bind-value="{{userstring}}"
                   on-keyup="userstringChanged"
                   class="form-control"
                   aria-describedby="basic-addon2"
            >
            <span class="input-group-addon" id="basic-addon2">{{fifdimension}}</span>
        </div>

        <br />

        <button on-click="fifreset">Reset</button>

    </template>

    <script>

        function isNumeric(n) { return !isNaN(parseFloat(n)) && isFinite(n); }

        Polymer({

            ready: function() {
                this.fifdimension = "Tommy";
                console.log('Ready');
            },

            fifreset: function() {
                this.userstring = 'Tres';
                this.fifdimension = 'Ass';
            },

            userstringChanged: function() {
                var someString = this.userstring ;
                var feet = 0;
                var inches = 0;
                var denominator = 64 ;
                var numerator = 0;

                if( isNumeric( someString ) )
                {
                    someString = Math.round( someString * 64 ) / 64 ;
                    feet = Math.floor( someString / 12 );
                    inch = Math.floor( someString - ( feet * 12 )) ;
                    numerator = Math.round(( someString - ( feet * 12 ) - inch ) * denominator );

                    for( denom = denominator; denom > 1 && ( numerator % 2 ) == 0 ; denom--  )
                    {
                        numerator = numerator / 2 ;
                        denominator = denominator / 2 ;
                    }

                    this.fifdimension = feet + "'-" + inch + '-' + numerator + '/' + denominator + '"';
                }
                else
                {
                    this.fifdimension = '';
                }
            },

            is: "editable-fifrac-dimension",

            properties: {
                userstring: {
                    type: String,
                    value: "Thomas"
                }
            }


        });


    </script>

</dom-module>


